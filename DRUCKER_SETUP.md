# 62mm Drucker Setup-Anleitung\n\n## Hardware-Setup f√ºr ESC/POS Thermodrucker\n\n**Datum:** 26.06.2025  \n**System:** WartungsManager - Patronenwechsel Integration  \n**Drucker-Typ:** 62mm Thermodrucker (ESC/POS kompatibel)  \n\n---\n\n## üîå Hardware-Vorbereitung:\n\n### Unterst√ºtzte Drucker:\n- **Epson TM-T20II** (Empfohlen f√ºr USB)\n- **Star TSP143III** (Empfohlen f√ºr Bluetooth)\n- **Generische ESC/POS** 62mm Thermodrucker\n\n### Anschluss-Optionen:\n1. **USB:** Drucker direkt am Entwicklungsrechner\n2. **Ethernet:** Netzwerk-Drucker (f√ºr Produktiveinsatz)\n3. **Serial/RS232:** F√ºr √§ltere Drucker\n\n---\n\n## üì¶ Software-Installation:\n\n### 1. Python-Dependencies installieren:\n```bash\ncd C:\\SoftwareProjekte\\WartungsManager\\Source\\Python\n\n# Virtual Environment aktivieren\nwartung_env\\Scripts\\activate\n\n# Neue Dependencies installieren\npip install python-escpos==3.0a9 qrcode==7.4.2\n\n# Installation √ºberpr√ºfen\npip list | findstr escpos\npip list | findstr qrcode\n```\n\n### 2. Datenbank-Migration:\n```bash\n# Migration generieren\npython -m flask db migrate -m \"Add 62mm printer support models\"\n\n# Migration ausf√ºhren\npython -m flask db upgrade\n\n# Erfolg √ºberpr√ºfen\npython -c \"from app.models.print_jobs import PrinterKonfiguration; print('Models erfolgreich geladen!')\"\n```\n\n---\n\n## üñ®Ô∏è Drucker-Konfiguration:\n\n### USB-Drucker (Standard):\n\n1. **Hardware anschlie√üen:**\n   - 62mm Thermodrucker per USB verbinden\n   - Windows-Treiber installieren (falls erforderlich)\n   - Drucker in Ger√§te-Manager √ºberpr√ºfen\n\n2. **Vendor/Product IDs ermitteln:**\n```python\n# Python-Script f√ºr USB-Erkennung\nimport usb.core\n\ndevices = usb.core.find(find_all=True)\nfor device in devices:\n    if \"printer\" in str(device).lower():\n        print(f\"Vendor ID: 0x{device.idVendor:04x}\")\n        print(f\"Product ID: 0x{device.idProduct:04x}\")\n```\n\n3. **Standard-Konfiguration erstellen:**\n```python\n# In Flask Shell ausf√ºhren\nfrom app import db\nfrom app.models.print_jobs import PrinterKonfiguration\nimport json\n\n# Standard USB-Drucker konfigurieren\ndrucker = PrinterKonfiguration(\n    name=\"Hauptdrucker 62mm\",\n    drucker_typ=\"Epson TM-T20II\",\n    interface_typ=\"usb\",\n    papier_breite_mm=62,\n    max_zeichen_pro_zeile=42,\n    ist_aktiv=True,\n    ist_standard=True,\n    erstellt_von=\"System-Setup\"\n)\n\n# USB-Konfiguration\nusb_config = {\n    \"vendor_id\": 0x04b8,   # Epson Standard\n    \"product_id\": 0x0202, # TM-T20II\n    \"profile\": \"TM-T20\",\n    \"encoding\": \"cp850\"   # Deutsche Umlaute\n}\ndrucker.set_verbindung_dict(usb_config)\n\ndb.session.add(drucker)\ndb.session.commit()\n\nprint(f\"Drucker konfiguriert: ID {drucker.id}\")\n```\n\n---\n\n## üß™ Erste Tests:\n\n### 1. Drucker-Verbindungstest:\n```bash\n# Flask-Server starten\npython run.py\n```\n\n**Im Browser:**\n- Zu `http://localhost:5000/patronenwechsel` navigieren\n- Auf \"Statistiken\" Sektion wechseln\n- \"Drucker-Test\" Button klicken (falls implementiert)\n\n**Via API-Test:**\n```bash\n# Test-Request (PowerShell)\nInvoke-RestMethod -Uri \"http://localhost:5000/patronenwechsel/api/printer/test/1\" -Method POST\n```\n\n### 2. Test-Etikett drucken:\n```python\n# Python-Test-Script\nfrom app.services.print_service import print_service\nfrom app.models.print_jobs import PrinterKonfiguration\n\n# Drucker testen\ndrucker = PrinterKonfiguration.query.first()\nresult = print_service.test_printer_connection(drucker)\nprint(result)\n```\n\n### 3. Patronenwechsel-Etikett:\n- Patronenwechsel in der Anwendung durchf√ºhren\n- In Historie auf \"Print\"-Button klicken\n- Etikett sollte automatisch gedruckt werden\n\n---\n\n## üõ†Ô∏è Troubleshooting:\n\n### Problem: \"python-escpos not found\"\n**L√∂sung:**\n```bash\n# Dependencies erneut installieren\npip install --upgrade python-escpos==3.0a9\n\n# Bei Problemen: Entwicklungs-Version\npip install https://github.com/python-escpos/python-escpos/archive/development.zip\n```\n\n### Problem: \"USB Drucker nicht erkannt\"\n**L√∂sung:**\n```bash\n# USB-Treiber √ºberpr√ºfen\n# Windows: Ger√§te-Manager ‚Üí Drucker\n# Linux: lsusb | grep -i printer\n\n# Berechtigungen (Linux)\nsudo usermod -a -G lp $USER\nsudo usermod -a -G dialout $USER\n```\n\n### Problem: \"Permission denied\"\n**L√∂sung (Windows):**\n- Python als Administrator ausf√ºhren\n- USB-Treiber neu installieren\n- Windows-Drucker-Spooler neustarten\n\n### Problem: \"Etikett wird abgeschnitten\"\n**L√∂sung:**\n```python\n# Drucker-Konfiguration anpassen\ndrucker.max_zeichen_pro_zeile = 38  # Weniger Zeichen\ndrucker.papier_breite_mm = 58       # Falls schmaler\ndb.session.commit()\n```\n\n---\n\n## ‚úÖ Erfolgreiche Installation √ºberpr√ºfen:\n\n### Checkliste:\n- [ ] **Dependencies installiert** (`pip list` zeigt escpos + qrcode)\n- [ ] **Datenbank migriert** (Keine Fehler bei `flask db upgrade`)\n- [ ] **Drucker konfiguriert** (PrinterKonfiguration in DB)\n- [ ] **USB-Verbindung** (Drucker wird in System erkannt)\n- [ ] **Test-Ausdruck erfolgreich** (Etikett wird gedruckt)\n- [ ] **Web-UI funktional** (Print-Buttons reagieren)\n- [ ] **API-Endpoints** (Alle Print-APIs antworten)\n\n### Bei Erfolg:\n```\nüéâ 62mm Drucker-Integration erfolgreich!\n\nSie k√∂nnen jetzt:\n‚úÖ Patronenwechsel-Etiketten drucken\n‚úÖ QR-Codes f√ºr Wartungslinks generieren\n‚úÖ Wiederholungsdrucke aus der Historie\n‚úÖ Druckwarteschlange verwalten\n```\n\n---\n\n## üìû Support:\n\n### Bei anhaltenden Problemen:\n1. **Logs pr√ºfen:** `Logs/error.log`\n2. **Debug-Modus:** `FLASK_ENV=development`\n3. **Dummy-Modus:** Funktioniert ohne Hardware\n4. **Claude-Chat:** Weiteren Support anfordern\n\n### Erweiterte Konfiguration:\n- **Netzwerk-Drucker:** Ethernet-Setup f√ºr Produktivumgebung\n- **Mehrere Drucker:** Multi-Drucker Konfiguration\n- **Custom-Layouts:** Etikett-Design anpassen\n- **Automation:** Automatischer Druck nach Patronenwechsel\n\n---\n\n**Setup-Version:** 1.0  \n**Erstellt:** 26.06.2025  \n**Getestet mit:** Python 3.11, Flask 2.3.3, Windows 11  